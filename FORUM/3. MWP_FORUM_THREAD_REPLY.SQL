--changed the value type of FORUM_THREAD_REPLY_MESSAGE to varchar 4000
DECLARE 
  errTableDataCount NUMBER;
  CURSOR c IS 
  SELECT 
    mwp.FORUM_THREAD_ID as FORUM_THREAD_ID,
    mwpu.USERID as USERID,
    REPLY_MESSAGE,
    REPLY_TIMESTAMP,
    1 as ispublished,
    0 as isdeleted,
    REPLY_ID
  FROM PORTAL.TBL_FORUM_REPLY por
  LEFT JOIN MWP_FORUM_THREAD mwp ON por.THREAD_ID = mwp.TEMP_ID
  LEFT JOIN USERS mwpu ON mwpu.USERNAME = por.USER_NAME;
  rc c%ROWTYPE;
BEGIN
  OPEN c;
  LOOP
  FETCH c INTO rc;
  EXIT WHEN c%NOTFOUND;
  
  INSERT
  INTO MWP_FORUM_THREAD_REPLY
  (
    FORUM_THREAD_ID,
    FORUM_THREAD_USER_ID,
    FORUM_THREAD_REPLY_MESSAGE,
    FORUM_THREAD_REPLY_TIMESTAMP,
    FORUM_THREAD_ISPUBLISHED,
    FORUM_THREAD_ISEDELETED,
    TEMP_ID
  )
  VALUES(rc.FORUM_THREAD_ID,rc.USERID,rc.REPLY_MESSAGE,rc.REPLY_TIMESTAMP,rc.ispublished,rc.isdeleted,rc.REPLY_ID)
  LOG ERRORS INTO ERR$_MWP_FORUM_THREAD_REPLY ('INSERT') REJECT LIMIT UNLIMITED;
END LOOP;
COMMIT;
END;

